{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { registerLocaleData } from '@angular/common';\nimport { NgZone } from '@angular/core';\nimport { NavigationEnd } from '@angular/router';\nimport { LocalNotifications } from '@capacitor/local-notifications';\nimport { environment } from 'src/environments/environment';\nimport { NotificationEventEnum } from './shared/models/NotificationEvent.enum';\nimport localeFr from '@angular/common/locales/fr';\nimport localeNl from '@angular/common/locales/nl';\nimport { Network } from '@capacitor/network';\nimport { LocalStorageEnum } from './shared/models/LocalStorage.enum';\nimport { App } from '@capacitor/app';\nimport { filter, map, mergeMap, tap } from 'rxjs/operators';\nimport { SellingPage } from './pages/selling/selling.page';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"./shared/services/data/volunteer-shift/volunteer-shift.service\";\nimport * as i3 from \"./shared/services/communication/language.communication.service\";\nimport * as i4 from \"./shared/services/communication/loading.communication.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@ngx-translate/core\";\nimport * as i7 from \"./shared/services/data/info-list/info-list.service\";\nimport * as i8 from \"./shared/services/data/programme/programme.service\";\nimport * as i9 from \"./shared/services/communication/back-buttton.communication.service\";\nimport * as i10 from \"@angular/common\";\n\nconst _c0 = function (a0) {\n  return [a0];\n};\n\nfunction AppComponent_ion_menu_toggle_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-menu-toggle\", 17)(1, \"ion-item\", 18);\n    i0.ɵɵelement(2, \"ion-icon\", 19);\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const p_r3 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(6, _c0, p_r3.url));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ios\", p_r3.icon + \"-outline\")(\"md\", p_r3.icon + \"-sharp\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 4, \"Menu.\" + p_r3.title));\n  }\n}\n\nfunction AppComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"div\", 21);\n    i0.ɵɵelement(2, \"ion-spinner\", 22);\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction AppComponent_ion_fab_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-fab\", 23)(1, \"ion-fab-button\", 24);\n    i0.ɵɵelement(2, \"ion-icon\", 25);\n    i0.ɵɵelementEnd()();\n  }\n}\n\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(platform, volunteerShiftService, languageCommunication, loadingCommunication, router, activatedRoute, menu, modalController, translate, toastController, infoListService, programmeService, loadingController, zone, backButtonBlock) {\n      this.platform = platform;\n      this.volunteerShiftService = volunteerShiftService;\n      this.languageCommunication = languageCommunication;\n      this.loadingCommunication = loadingCommunication;\n      this.router = router;\n      this.activatedRoute = activatedRoute;\n      this.menu = menu;\n      this.modalController = modalController;\n      this.translate = translate;\n      this.toastController = toastController;\n      this.infoListService = infoListService;\n      this.programmeService = programmeService;\n      this.loadingController = loadingController;\n      this.zone = zone;\n      this.backButtonBlock = backButtonBlock;\n      this.appPages = [{\n        title: 'Home',\n        url: 'home',\n        icon: 'home'\n      }, {\n        title: 'Programme',\n        url: 'programme',\n        icon: 'calendar'\n      }, {\n        title: 'News',\n        url: 'news-info',\n        icon: 'newspaper'\n      }, {\n        title: 'MyManifiesta',\n        url: 'my-manifiesta',\n        icon: 'person-circle'\n      }, {\n        title: 'Selling',\n        url: 'selling',\n        icon: 'ticket'\n      }, {\n        title: 'About',\n        url: 'about',\n        icon: 'information-circle'\n      } // { title: 'Map', url: 'map', icon: 'map' },\n      ];\n      this.showNewsletterButton = true;\n      this.pagesToShowNewsletterButton = ['/home', '/news-info', '/new-detail'];\n      this.openLangModal = false;\n      this.isLoading = true;\n    }\n\n    ngOnInit() {\n      return __awaiter(this, void 0, void 0, function* () {\n        // await LocalNotifications.requestPermissions();\n        this.init();\n        LocalNotifications.addListener('localNotificationActionPerformed', n => {\n          if (n.actionId === 'tap') {\n            if (n.notification.actionTypeId === NotificationEventEnum.EventFav) {\n              this.router.navigate(['/programme', 'event-detail', n.notification.id]);\n            }\n          }\n        });\n        this.languageCommunication.langHasChangeEvent.subscribe(l => {\n          this.menu.close();\n        });\n      });\n    } // We need at the launch of the app to verify if there is update of the schedule of event\n    // First we get the schedule update file and check if in the local storage we have the last 'code'\n    // If not, we need to check and reload the notif with the new hours\n\n\n    verifyScheduleUpdate() {\n      return __awaiter(this, void 0, void 0, function* () {\n        if (!localStorage.getItem(LocalStorageEnum.AvoidNotification) && localStorage.getItem(LocalStorageEnum.FavoriteId)) {\n          const loading = yield this.loadingController.create({\n            message: 'Please wait...',\n            spinner: 'lines'\n          });\n          yield loading === null || loading === void 0 ? void 0 : loading.present();\n          this.infoListService.getScheduleUpdate().subscribe(scheduleUpdate => __awaiter(this, void 0, void 0, function* () {\n            const code = scheduleUpdate[scheduleUpdate.length - 1].code;\n            const codePresent = localStorage.getItem(code);\n\n            if (!codePresent) {\n              yield this.programmeService.addAllNotification();\n              localStorage.setItem(code, 'done');\n              yield loading === null || loading === void 0 ? void 0 : loading.dismiss();\n            } else {\n              yield loading === null || loading === void 0 ? void 0 : loading.dismiss();\n            }\n          })).add(() => __awaiter(this, void 0, void 0, function* () {\n            yield loading === null || loading === void 0 ? void 0 : loading.dismiss();\n          }));\n        }\n      });\n    }\n\n    init() {\n      return __awaiter(this, void 0, void 0, function* () {\n        // more routing init\n        App.addListener('appUrlOpen', event => {\n          this.zone.run(() => {\n            const slug = event.url.includes('mycallbackscheme://selling'); // Expected url call back\n            // mycallbackscheme://seller?action=sale&amount=101&clientTransactionId=&message=(-4) USER_CANCEL&status=fail&tid=16220044\n\n            if (slug || event.url === 'selling') {\n              this.router.navigateByUrl(`${event.url.replace('mycallbackscheme://', '/')}&timestamp=${new Date().getTime()}`);\n            } // If no match, do nothing - let regular routing\n            // logic take over\n\n          });\n        });\n        registerLocaleData(localeFr);\n        registerLocaleData(localeNl);\n        this.languageCommunication.init();\n        yield this.verifyScheduleUpdate();\n        Network.getStatus().then(n => {\n          if (!n.connected) {\n            this.translate.get('General.NoConnection').subscribe(t => {\n              this.toastController.create({\n                header: 'INTERNET ?',\n                message: t,\n                icon: 'alert-circle-outline',\n                color: 'danger',\n                position: 'bottom',\n                duration: 7000\n              }).then(toast => {\n                toast.present();\n              });\n            });\n          }\n        });\n        console.log('You use the platform: ', this.platform.platforms(), this.languageCommunication.translate.currentLang, environment.production); // when the user tap on the physical back button of the device, we want to close the app\n        // but not for all page !\n\n        const pageWithoutBackButton = ['/programme/event-detail', '/programme/new-detail'];\n        this.showNewsletterButton = this.pagesToShowNewsletterButton.findIndex(x => this.router.url.includes(x)) > -1;\n        this.router.events.pipe(filter(event => event instanceof NavigationEnd), tap(event => {\n          this.showNewsletterButton = this.pagesToShowNewsletterButton.findIndex(x => event['urlAfterRedirects'].includes(x)) > -1;\n        }), map(() => this.activatedRoute), map(route => {\n          while (route.firstChild) route = route.firstChild;\n\n          return route;\n        }), filter(route => route.outlet === 'primary'), mergeMap(route => route.data)).subscribe(snapshotData => {\n          var _a;\n\n          (_a = this.subBackButton) === null || _a === void 0 ? void 0 : _a.unsubscribe();\n          this.subBackButton = this.platform.backButton.subscribe(() => {\n            const app = 'app';\n            this.menu.isOpen().then(data => {\n              var _a, _b; // We need to verify that we are not on the menu\n\n\n              if (!data && !snapshotData.noBackExit && ((_a = this.backButtonBlock.blockReference) === null || _a === void 0 ? void 0 : _a.length) === 0) {\n                navigator[app].exitApp();\n              } else if (((_b = this.backButtonBlock.blockReference) === null || _b === void 0 ? void 0 : _b.length) > 0 && this.backButtonBlock.blockReference.includes(SellingPage.name)) {\n                this.backButtonBlock.sendGoBackToSellingPage();\n              }\n            });\n          });\n        });\n      });\n    }\n\n    ionViewWillLeave() {\n      var _a, _b;\n\n      (_a = this.subRouter) === null || _a === void 0 ? void 0 : _a.unsubscribe();\n      (_b = this.subBackButton) === null || _b === void 0 ? void 0 : _b.unsubscribe();\n    }\n\n  }\n\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.Platform), i0.ɵɵdirectiveInject(i2.VolunteerShiftService), i0.ɵɵdirectiveInject(i3.LanguageCommunicationService), i0.ɵɵdirectiveInject(i4.LoadingCommunicationService), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i1.MenuController), i0.ɵɵdirectiveInject(i1.ModalController), i0.ɵɵdirectiveInject(i6.TranslateService), i0.ɵɵdirectiveInject(i1.ToastController), i0.ɵɵdirectiveInject(i7.InfoListService), i0.ɵɵdirectiveInject(i8.ProgrammeService), i0.ɵɵdirectiveInject(i1.LoadingController), i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i9.BackButtonCommunicationService));\n  };\n\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    decls: 19,\n    vars: 5,\n    consts: [[\"contentId\", \"main-content\"], [\"contentId\", \"main-content\", \"type\", \"overlay\"], [\"id\", \"inbox-list\"], [\"src\", \"assets/pictures/manifiesta-colorfull-logo.png\", \"alt\", \"logo\"], [\"auto-hide\", \"false\", 4, \"ngFor\", \"ngForOf\"], [1, \"flex-horizontal-space-around\"], [\"alt\", \"instagram\", \"target\", \"_blank\", 3, \"href\"], [\"name\", \"logo-instagram\", \"color\", \"instagram\", 1, \"big-icon\"], [\"alt\", \"facebook\", \"target\", \"_blank\", 3, \"href\"], [\"name\", \"logo-facebook\", \"color\", \"facebook\", 1, \"big-icon\"], [\"href\", \"https://open.spotify.com/user/manifiesta.be\", \"alt\", \"spotify\", \"target\", \"_blank\"], [\"name\", \"musical-notes\", \"color\", \"spotify\", 1, \"big-icon\"], [\"href\", \"https://twitter.com/manifiesta_be\", \"alt\", \"twitter\", \"target\", \"_blank\"], [\"name\", \"logo-twitter\", \"color\", \"twitter\", 1, \"big-icon\"], [\"id\", \"main-content\"], [\"class\", \"loading-block\", 4, \"ngIf\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\", \"slot\", \"fixed\", 4, \"ngIf\"], [\"auto-hide\", \"false\"], [\"routerDirection\", \"root\", \"lines\", \"none\", \"detail\", \"false\", \"routerLinkActive\", \"selected\", 3, \"routerLink\"], [\"slot\", \"start\", 3, \"ios\", \"md\"], [1, \"loading-block\"], [1, \"loading-inside\"], [\"name\", \"lines\", \"color\", \"primary\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\", \"slot\", \"fixed\"], [\"href\", \"https://manifiesta.us10.list-manage.com/subscribe?u=92016822490930eea187c6b99&id=f9502beef0\", \"color\", \"secondary\"], [\"name\", \"mail-open-outline\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-app\")(1, \"ion-split-pane\", 0)(2, \"ion-menu\", 1)(3, \"ion-content\")(4, \"ion-list\", 2);\n        i0.ɵɵelement(5, \"img\", 3);\n        i0.ɵɵtemplate(6, AppComponent_ion_menu_toggle_6_Template, 6, 8, \"ion-menu-toggle\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 5)(8, \"a\", 6);\n        i0.ɵɵelement(9, \"ion-icon\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"a\", 8);\n        i0.ɵɵelement(11, \"ion-icon\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"a\", 10);\n        i0.ɵɵelement(13, \"ion-icon\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"a\", 12);\n        i0.ɵɵelement(15, \"ion-icon\", 13);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelement(16, \"ion-router-outlet\", 14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(17, AppComponent_div_17_Template, 3, 0, \"div\", 15);\n        i0.ɵɵtemplate(18, AppComponent_ion_fab_18_Template, 3, 0, \"ion-fab\", 16);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.appPages);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"href\", \"https://www.instagram.com/manifiesta.\" + ctx.languageCommunication.translate.currentLang, i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"href\", ctx.languageCommunication.translate.currentLang === \"nl\" ? \"https://www.facebook.com/manifiesta.nl\" : \"https://www.facebook.com/profile.php?id=100085999362192\", i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", (ctx.loadingCommunication.isLoading == null ? null : ctx.loadingCommunication.isLoading.length) > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showNewsletterButton);\n      }\n    },\n    dependencies: [i10.NgForOf, i10.NgIf, i1.IonApp, i1.IonContent, i1.IonFab, i1.IonFabButton, i1.IonIcon, i1.IonItem, i1.IonLabel, i1.IonList, i1.IonMenu, i1.IonMenuToggle, i1.IonSpinner, i1.IonSplitPane, i1.IonRouterOutlet, i1.RouterLinkDelegate, i5.RouterLink, i5.RouterLinkActive, i6.TranslatePipe],\n    styles: [\"ion-menu[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: var(--ion-item-background, var(--ion-background-color, #fff))}ion-menu.md[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px;--padding-top: 20px;--padding-bottom: 20px}ion-menu.md[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding:20px 0}ion-menu.md[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{margin-bottom:30px}ion-menu.md[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%], ion-menu.md[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{padding-left:10px}ion-menu.md[_ngcontent-%COMP%]   ion-list#inbox-list[_ngcontent-%COMP%]{border-bottom:1px solid var(--ion-color-step-150, #d7d8da)}ion-menu.md[_ngcontent-%COMP%]   ion-list#inbox-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{font-size:22px;font-weight:600;min-height:20px}ion-menu.md[_ngcontent-%COMP%]   ion-list#labels-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{font-size:16px;margin-bottom:18px;color:#757575;min-height:26px}ion-menu.md[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 10px;--padding-end: 10px;border-radius:4px}ion-menu.md[_ngcontent-%COMP%]   ion-item.selected[_ngcontent-%COMP%]{--background: rgba(var(--ion-color-primary-rgb), .14)}ion-menu.md[_ngcontent-%COMP%]   ion-item.selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}ion-menu.md[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#616e7e}ion-menu.md[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:500}ion-menu.ios[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--padding-bottom: 20px}ion-menu.ios[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding:20px 0 0}ion-menu.ios[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{line-height:24px;margin-bottom:20px}ion-menu.ios[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--min-height: 50px}ion-menu.ios[_ngcontent-%COMP%]   ion-item.selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}ion-menu.ios[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:#73849a}ion-menu.ios[_ngcontent-%COMP%]   ion-list#labels-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{margin-bottom:8px}ion-menu.ios[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%], ion-menu.ios[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{padding-left:16px;padding-right:16px}ion-menu.ios[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{margin-bottom:8px}ion-note[_ngcontent-%COMP%]{display:inline-block;font-size:16px;color:var(--ion-color-medium-shade)}ion-item.selected[_ngcontent-%COMP%]{--color: var(--ion-color-primary)}\"]\n  });\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}